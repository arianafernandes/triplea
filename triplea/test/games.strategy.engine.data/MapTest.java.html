<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../.resources/report.gif" type="image/gif"/><title>MapTest.java</title><link rel="stylesheet" href="../../../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../../.sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">test (25/nov/2016 10:16:58)</a> &gt; <a href="../../index.html" class="el_group">triplea</a> &gt; <a href="../index.html" class="el_bundle">test</a> &gt; <a href="index.source.html" class="el_package">games.strategy.engine.data</a> &gt; <span class="el_source">MapTest.java</span></div><h1>MapTest.java</h1><pre class="source lang-java linenums"><span class="fc" id="L1">package games.strategy.engine.data;</span>

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertNotNull;
import static org.junit.Assert.assertNull;
import static org.junit.Assert.assertTrue;

import java.util.Set;

import org.junit.Before;
import org.junit.Test;

import games.strategy.util.Match;

<span class="fc" id="L15">public class MapTest {</span>
  Territory aa;
  Territory ab;
  Territory ac;
  Territory ad;
  Territory ba;
  Territory bb;
  Territory bc;
  Territory bd;
  Territory ca;
  Territory cb;
  Territory cc;
  Territory cd;
  Territory da;
  Territory db;
  Territory dc;
  Territory dd;
  Territory nowhere;
  GameMap map;

  @Before
  public void setUp() {
    // map, l is land, w is water
    // each territory is connected to
    // it's direct neighbors, but not diagonals
    // llll
    // llww
    // llwl
    // llww
<span class="fc" id="L44">    aa = new Territory(&quot;aa&quot;, false, null);</span>
<span class="fc" id="L45">    ab = new Territory(&quot;ab&quot;, false, null);</span>
<span class="fc" id="L46">    ac = new Territory(&quot;ac&quot;, false, null);</span>
<span class="fc" id="L47">    ad = new Territory(&quot;ad&quot;, false, null);</span>
<span class="fc" id="L48">    ba = new Territory(&quot;ba&quot;, false, null);</span>
<span class="fc" id="L49">    bb = new Territory(&quot;bb&quot;, false, null);</span>
<span class="fc" id="L50">    bc = new Territory(&quot;bc&quot;, true, null);</span>
<span class="fc" id="L51">    bd = new Territory(&quot;bd&quot;, true, null);</span>
<span class="fc" id="L52">    ca = new Territory(&quot;ca&quot;, false, null);</span>
<span class="fc" id="L53">    cb = new Territory(&quot;cb&quot;, false, null);</span>
<span class="fc" id="L54">    cc = new Territory(&quot;cc&quot;, true, null);</span>
<span class="fc" id="L55">    cd = new Territory(&quot;cd&quot;, false, null);</span>
<span class="fc" id="L56">    da = new Territory(&quot;da&quot;, false, null);</span>
<span class="fc" id="L57">    db = new Territory(&quot;db&quot;, false, null);</span>
<span class="fc" id="L58">    dc = new Territory(&quot;dc&quot;, true, null);</span>
<span class="fc" id="L59">    dd = new Territory(&quot;dd&quot;, true, null);</span>
<span class="fc" id="L60">    map = new GameMap(null);</span>
<span class="fc" id="L61">    map.addTerritory(aa);</span>
<span class="fc" id="L62">    map.addTerritory(ab);</span>
<span class="fc" id="L63">    map.addTerritory(ac);</span>
<span class="fc" id="L64">    map.addTerritory(ad);</span>
<span class="fc" id="L65">    map.addTerritory(ba);</span>
<span class="fc" id="L66">    map.addTerritory(bb);</span>
<span class="fc" id="L67">    map.addTerritory(bc);</span>
<span class="fc" id="L68">    map.addTerritory(bd);</span>
<span class="fc" id="L69">    map.addTerritory(ca);</span>
<span class="fc" id="L70">    map.addTerritory(cb);</span>
<span class="fc" id="L71">    map.addTerritory(cc);</span>
<span class="fc" id="L72">    map.addTerritory(cd);</span>
<span class="fc" id="L73">    map.addTerritory(da);</span>
<span class="fc" id="L74">    map.addTerritory(db);</span>
<span class="fc" id="L75">    map.addTerritory(dc);</span>
<span class="fc" id="L76">    map.addTerritory(dd);</span>
<span class="fc" id="L77">    map.addConnection(aa, ab);</span>
<span class="fc" id="L78">    map.addConnection(ab, ac);</span>
<span class="fc" id="L79">    map.addConnection(ac, ad);</span>
<span class="fc" id="L80">    map.addConnection(ba, bb);</span>
<span class="fc" id="L81">    map.addConnection(bb, bc);</span>
<span class="fc" id="L82">    map.addConnection(bc, bd);</span>
<span class="fc" id="L83">    map.addConnection(ca, cb);</span>
<span class="fc" id="L84">    map.addConnection(cb, cc);</span>
<span class="fc" id="L85">    map.addConnection(cc, cd);</span>
<span class="fc" id="L86">    map.addConnection(da, db);</span>
<span class="fc" id="L87">    map.addConnection(db, dc);</span>
<span class="fc" id="L88">    map.addConnection(dc, dd);</span>
<span class="fc" id="L89">    map.addConnection(aa, ba);</span>
<span class="fc" id="L90">    map.addConnection(ba, ca);</span>
<span class="fc" id="L91">    map.addConnection(ca, da);</span>
<span class="fc" id="L92">    map.addConnection(ab, bb);</span>
<span class="fc" id="L93">    map.addConnection(bb, cb);</span>
<span class="fc" id="L94">    map.addConnection(cb, db);</span>
<span class="fc" id="L95">    map.addConnection(ac, bc);</span>
<span class="fc" id="L96">    map.addConnection(bc, cc);</span>
<span class="fc" id="L97">    map.addConnection(cc, dc);</span>
<span class="fc" id="L98">    map.addConnection(ad, bd);</span>
<span class="fc" id="L99">    map.addConnection(bd, cd);</span>
<span class="fc" id="L100">    map.addConnection(cd, dd);</span>
<span class="fc" id="L101">    nowhere = new Territory(&quot;nowhere&quot;, false, null);</span>
<span class="fc" id="L102">  }</span>

  @Test
  public void testNowhere() {
<span class="pc bpc" id="L106" title="1 of 2 branches missed.">    assertTrue(-1 == map.getDistance(aa, nowhere));</span>
<span class="fc" id="L107">  }</span>

  @Test
  public void testCantFindByName() {
<span class="fc" id="L111">    assertNull(map.getTerritory(&quot;nowhere&quot;));</span>
<span class="fc" id="L112">  }</span>

  @Test
  public void testCanFindByName() {
<span class="fc" id="L116">    assertNotNull(map.getTerritory(&quot;aa&quot;));</span>
<span class="fc" id="L117">  }</span>

  @Test
  public void testSame() {
<span class="pc bpc" id="L121" title="1 of 2 branches missed.">    assertTrue(0 == map.getDistance(aa, aa));</span>
<span class="fc" id="L122">  }</span>

  @Test
  public void testImpossibleConditionRoute() {
<span class="fc" id="L126">    final Match&lt;Territory&gt; test = new Match&lt;Territory&gt;() {</span>
      @Override
      public boolean match(final Territory t) {
<span class="fc" id="L129">        return false;</span>
      }
    };
<span class="fc" id="L132">    assertNull(map.getRoute(aa, ba, test));</span>
<span class="fc" id="L133">  }</span>

  @Test
  public void testOne() {
<span class="fc" id="L137">    final int distance = map.getDistance(aa, ab);</span>
<span class="pc bpc" id="L138" title="1 of 2 branches missed.">    assertTrue(&quot;&quot; + distance, 1 == distance);</span>
<span class="fc" id="L139">  }</span>

  @Test
  public void testTwo() {
<span class="fc" id="L143">    final int distance = map.getDistance(aa, ac);</span>
<span class="pc bpc" id="L144" title="1 of 2 branches missed.">    assertTrue(&quot;&quot; + distance, 2 == distance);</span>
<span class="fc" id="L145">  }</span>

  @Test
  public void testOverWater() {
<span class="pc bpc" id="L149" title="1 of 2 branches missed.">    assertTrue(map.getDistance(ca, cd) == 3);</span>
<span class="fc" id="L150">  }</span>

  @Test
  public void testOverWaterCantReach() {
<span class="pc bpc" id="L154" title="1 of 2 branches missed.">    assertTrue(map.getLandDistance(ca, cd) == -1);</span>
<span class="fc" id="L155">  }</span>

  @Test
  public void testLong() {
<span class="pc bpc" id="L159" title="1 of 2 branches missed.">    assertTrue(map.getLandDistance(ad, da) == 6);</span>
<span class="fc" id="L160">  }</span>

  @Test
  public void testLongRoute() {
<span class="fc" id="L164">    final Route route = map.getLandRoute(ad, da);</span>
<span class="fc" id="L165">    assertEquals(route.numberOfSteps(), 6);</span>
<span class="fc" id="L166">  }</span>

  @Test
  public void testNeighborLandNoSeaConnect() {
<span class="pc bpc" id="L170" title="1 of 2 branches missed.">    assertTrue(-1 == map.getWaterDistance(aa, ab));</span>
<span class="fc" id="L171">  }</span>

  public void testNeighborSeaNoLandConnect() {
<span class="nc bnc" id="L174" title="All 2 branches missed.">    assertTrue(-1 == map.getLandDistance(bc, bd));</span>
<span class="nc" id="L175">  }</span>

  @Test
  public void testRouteToSelf() {
<span class="fc" id="L179">    final Route rt = map.getRoute(aa, aa);</span>
<span class="pc bpc" id="L180" title="1 of 2 branches missed.">    assertTrue(rt.numberOfSteps() == 0);</span>
<span class="fc" id="L181">  }</span>

  @Test
  public void testRouteSizeOne() {
<span class="fc" id="L185">    final Route rt = map.getRoute(aa, ab);</span>
<span class="pc bpc" id="L186" title="1 of 2 branches missed.">    assertTrue(rt.numberOfSteps() == 1);</span>
<span class="fc" id="L187">  }</span>

  @Test
  public void testImpossibleRoute() {
<span class="fc" id="L191">    final Route rt = map.getRoute(aa, nowhere);</span>
<span class="fc" id="L192">    assertNull(rt);</span>
<span class="fc" id="L193">  }</span>

  @Test
  public void testImpossibleLandRoute() {
<span class="fc" id="L197">    final Route rt = map.getLandRoute(aa, cd);</span>
<span class="pc bpc" id="L198" title="1 of 2 branches missed.">    assertTrue(rt == null);</span>
<span class="fc" id="L199">  }</span>

  @Test
  public void testImpossibleLandDistance() {
<span class="fc" id="L203">    final int distance = map.getLandDistance(aa, cd);</span>
<span class="pc bpc" id="L204" title="1 of 2 branches missed.">    assertTrue(&quot;wrongDistance exp -1, got:&quot; + distance, distance == -1);</span>
<span class="fc" id="L205">  }</span>

  @Test
  public void testWaterRout() {
<span class="fc" id="L209">    final Route rt = map.getWaterRoute(bd, dd);</span>
<span class="fc" id="L210">    assertTrue(&quot;bc:&quot; + rt, rt.getTerritoryAtStep(0).equals(bc));</span>
<span class="fc" id="L211">    assertTrue(&quot;cc&quot;, rt.getTerritoryAtStep(1).equals(cc));</span>
<span class="fc" id="L212">    assertTrue(&quot;dc&quot;, rt.getTerritoryAtStep(2).equals(dc));</span>
<span class="fc" id="L213">    assertTrue(&quot;dd&quot;, rt.getTerritoryAtStep(3).equals(dd));</span>
<span class="fc" id="L214">  }</span>

  @Test
  public void testMultiplePossible() {
<span class="fc" id="L218">    final Route rt = map.getRoute(aa, dd);</span>
<span class="fc" id="L219">    assertEquals(rt.getStart(), aa);</span>
<span class="fc" id="L220">    assertEquals(rt.getEnd(), dd);</span>
<span class="fc" id="L221">    assertEquals(rt.numberOfSteps(), 6);</span>
<span class="fc" id="L222">  }</span>

  @Test
  public void testNeighbors() {
<span class="fc" id="L226">    final Set&lt;Territory&gt; neighbors = map.getNeighbors(aa);</span>
<span class="pc bpc" id="L227" title="1 of 2 branches missed.">    assertTrue(neighbors.size() == 2);</span>
<span class="fc" id="L228">    assertTrue(neighbors.contains(ab));</span>
<span class="fc" id="L229">    assertTrue(neighbors.contains(ba));</span>
<span class="fc" id="L230">  }</span>

  @Test
  public void testNeighborsWithDistance() {
<span class="fc" id="L234">    Set&lt;Territory&gt; neighbors = map.getNeighbors(aa, 0);</span>
<span class="pc bpc" id="L235" title="1 of 2 branches missed.">    assertTrue(neighbors.size() == 0);</span>
<span class="fc" id="L236">    neighbors = map.getNeighbors(aa, 1);</span>
<span class="pc bpc" id="L237" title="1 of 2 branches missed.">    assertTrue(neighbors.size() == 2);</span>
<span class="fc" id="L238">    assertTrue(neighbors.contains(ab));</span>
<span class="fc" id="L239">    assertTrue(neighbors.contains(ba));</span>
<span class="fc" id="L240">    neighbors = map.getNeighbors(aa, 2);</span>
<span class="pc bpc" id="L241" title="1 of 2 branches missed.">    assertTrue(neighbors.size() == 5);</span>
<span class="fc" id="L242">    assertTrue(neighbors.contains(ab));</span>
<span class="fc" id="L243">    assertTrue(neighbors.contains(ac));</span>
<span class="fc" id="L244">    assertTrue(neighbors.contains(ba));</span>
<span class="fc" id="L245">    assertTrue(neighbors.contains(bb));</span>
<span class="fc" id="L246">    assertTrue(neighbors.contains(ca));</span>
<span class="fc" id="L247">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.6.201602180812</span>test (25/nov/2016 10:16:58)</div></body></html>